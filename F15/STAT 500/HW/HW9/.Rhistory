data(infmort)
??infmort
library(faraway)
data(infmort)
data(infmort)
library(faraway)
library(faraway)
data(infmort)
View(infmort)
class(infmort)
infmort = infmort(infmort$mortality != NA)
infmort = infmort[infmort$mortality != NA]
infmort = infmort[infmort$mortality != NA,]
infmort
library(faraway)
data(infmort)
data(infmort)
attach(infmort)
infmort <- na.omit(mortality)
library(faraway)
data(infmort)
attach(infmort)
na.omit(mortality)
infmort
dim(mortality)
dim(infmort)
library(faraway)
data(infmort)
attach(infmort)
dim(infmort)
na.omit(mortality)
View(infmort)
summary(infmort)
na.omit(infmort)
summary(infmort)
df = na.omit(infmort)
df
View(df)
g1 <- lm( morality ~ income+ region, df)
boxcox(g1, plotit =T)
library(MASS)
g1 <- lm( morality ~ income+ region, df)
boxcox(g1, plotit =T)
g1 <- lm(mortality ~ income+ region, df)
boxcox(g1, plotit =T)
summary(g1)
class(g1)
typeof
typeof(g1)
library(MASS)
data(trees)
attach(trees)
#part a
g1 <-  lm(Volume~ Girth +  Height)
boxcox(g1, plotit =T)
class(g1)
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
##transform the response
library(MASS)
g1 <- lm(mortality ~ income+ region, df)
boxcox(g1, plotit =T)
df = df[, -4]
g1 <- lm(mortality ~ income+ region, df)
boxcox(g1, plotit =T)
g1 <- lm(mortality ~ income+ region +income:region, df)
boxcox(g1, plotit =T)
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
df = df[, -4]
library(MASS)
g1 <- lm(mortality ~ income+ region +income:region, df)
boxcox(g1, plotit =T)
library(MASS)
g1 <- lm(mortality ~ income+ region,df)
boxcox(g1, plotit =T)
boxcox(g1,plotit =T)
??boxcox
class(g1)
typeof(g1)
library(MASS)
data(trees)
attach(trees)
#part a
g1 <-  lm(Volume~ Girth +  Height)
boxcox(g1, plotit =T)
boxcox(g1, lambda = seq
)
class(g1)
typeof(g1)
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
df = df[, -4]
##transform the response
library(MASS)
g1 <- lm(mortality ~ income+ region,df)
boxcox(g1, data = df, plotit =T)
library(MASS)
data(trees)
attach(trees)
#part a
g1 <-  lm(Volume~ Girth +  Height)
boxcox(g1, plotit =T)
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
df = df[, -4]
##transform the response
library(MASS)
g1 <- lm(mortality ~ income+ region,df)
boxcox(g1, data = df, plotit =T)
boxcox(g1, lambda = seq(-0.5, 0.0, by =0.05))
boxcox(g1, data = df,lambda = seq(-0.5, 0.0, by =0.05))
library(MASS)
data(trees)
attach(trees)
#part a
g1 <-  lm(Volume~ Girth +  Height)
boxcox(g1, plotit =T)
boxcox(g1, lambda = seq(0.0, 0.6, by =0.05))
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
df = df[, -4]
##transform the response
library(MASS)
g1 <- lm(mortality ~ income+ region,df)
boxcox(g1, data = df, plotit =T)
boxcox(g1, data = df,lambda = seq(-0.5, 0.0, by =0.05))
library(MASS)
g1 <- lm(mortality ~ income+ region,df)
boxcox(g1, data = df, plotit =T)
boxcox(g1, data = df,lambda = seq(-0.5, 0.0, by =0.05))
g2 <- lm(I(infmort^(-0.2))~ income + region)
g2 <- lm(I(mortality^(-0.2))~ income + region,df)
boxcox(g2, data = df,plotit =T,lambda = seq(-1, 1, by =0.05))
boxcox(g2, data = df,plotit =T,lambda = seq(-1, 4, by =0.05))
boxcox(g2, data = df,plotit =T,lambda = seq(-2, 4, by =0.05))
View(df)
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
df = df[, -4]
##transform the response
library(MASS)
g1 <- lm(mortality ~ income+ region+ income: region,df)
boxcox(g1, data = df, plotit =T)
boxcox(g1, data = df,lambda = seq(-0.5, 0.0, by =0.05))
g2 <- lm(I(mortality^(-0.2))~ income + region+ income: region,df)
summary(g1)
model.matrix(g1)
model.matrix(g1)
model.matrix(g2)
plot(g2)
boxcox(g2, data = df,plotit =T,lambda = seq(-2, 4, by =0.05))
summary(g1)
summary(g2)
g1 <- lm(I(mortality^(-0.2)) ~ income+ region+ income: region+ I(income^2) + I(income^3) + I(income^4),df)
g3 <- lm(I(mortality^(-0.2)) ~ income+ region+ income: region+ I(income^2) + I(income^3) + I(income^4),df)
summary(g3)
summary(g2)
g3 <- lm(I(mortality^(-0.2)) ~ income+ region+ I(income^2) + I(income^3) + I(income^4)+I(income^5) +I(income^6),df)
summary(g3)
g4 <- lm(I(mortality^(-0.2)) ~ income+ region+ I(income^2) + I(income^3) + I(income^4)+I(income^5),df)
summary(g4)
g5 <- lm(I(mortality^(-0.2)) ~ income+ region+ I(income^2) + I(income^3) + I(income^4),df)
summary(g5)
plot(g4)
plot(I(mortality^(-0.2)) ~ income + I(income^2) + I(income^3) + I(income^4)+I(income^5), df, pch = unclass(region))
identify(df$income,df$mortality)
cook<-cooks.distance(g4)
halfnorm(cook,nlab=3,ylab="Cook's Distance")
identify(df$income, df$mortality)
plot (I(mortality^(-0.2)) ~ income +I(income^2) + I(income^3) + I(income^4)+I(income^5), pch=as.character (region), df)
plot(mortality~ income,df)
plot(I(mortality^(-0.2))~income,df)
plot(log(mortality)~income,df)
indentify(income, mortality)
identify(income,mortality)
plot(mortality ~income, df)
cook<-cooks.distance(g4)
halfnorm(cook,nlab=3,ylab="Cook's Distance")
plot(mortality ~income, df)
identify(income,mortality)
plot((mortality^(-0.2)) ~income, df)
plot(log(mortality) ~income, df)
identify(income,mortality)
plot(mortality ~income, df)
cook<-cooks.distance(g4)
halfnorm(cook,nlab=3,ylab="Cook's Distance")
df[c(4,25,27),]
ti<-rstudent(g4)
pt(ti[4],df=101-5-1)
##Compute the p-value and compare with alpha/n
2*(1-pt(ti[4],df=101-5-1))-0.05/101
max(abs(ti))
which(ti == max(abs(ti)))
which(ti == max(abs(ti)))
pt(ti[25],df=101-5-1)
2*(1-pt(ti[25],df=101-5-1))-0.05/101
pt(ti[27],df=101-5-1)
2*(1-pt(ti[27],df=101-5-1))-0.05/101
0.05/101
2*(1-pt(ti[4],df=101-5-1))-0.05/101
##Canada  0.2406408
pt(ti[25],df=101-5-1)
2*(1-pt(ti[25],df=101-5-1))-0.05/101
##Libya 1.994081 not outlier
pt(ti[27],df=101-5-1)
2*(1-pt(ti[27],df=101-5-1))-0.05/101
## Saudi_Arabia 1.999482 not
ti<-rstudent(g4)
pt(ti[4],df=101-5-1)
##Compute the p-value and compare with alpha/n
2*(1-pt(ti[4],df=101-5-1))-0.05/101
##Canada  0.2406408
pt(ti[25],df=101-5-1)
2*(1-pt(ti[25],df=101-5-1))-0.05/101
##Libya 1.994081 not outlier
pt(ti[27],df=101-5-1)
2*(1-pt(ti[27],df=101-5-1))-0.05/101
plot(df$income, df$mortality)
identify(df$income, df$mortality)
pt(ti[72],df=101-5-1)
2*(1-pt(ti[72],df=101-5-1))-0.05/101
plot(g4$fitted.values,g4$residuals,xlab="Fitted",ylab="Residuals",main="")
abline(h=0)
qqnorm(g_4$residual,ylab="Residuals")
qqline(g_4$residual)
halfnorm(lm.influence(g_4)$hat,nlab=2,ylab="Leverages")
plot(g_4$residuals/((summary(g_4)$sig)*sqrt(1-lm.influence(g_4)$hat)), g_4$residuals,xlab="Studentized Residuals",ylab="Raw Residuals")
qqnorm(g4$residual,ylab="Residuals")
qqline(g4$residual)
halfnorm(lm.influence(g4)$hat,nlab=2,ylab="Leverages")
plot(g4$residuals/((summary(g4)$sig)*sqrt(1-lm.influence(g4)$hat)), g4$residuals,xlab="Studentized Residuals",ylab="Raw Residuals")
summary(g1)
summary(g2)
boxcox(g1, data = df, plotit =T)
boxcox(g1, data = df,lambda = seq(-0.5, 0.0, by =0.05))
boxcox(g1, data = df, plotit =T)
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
df = df[, -4]
##transform the response
library(MASS)
g1 <- lm(mortality ~ income+ region+ income: region,df)
boxcox(g1, data = df, plotit =T)
boxcox(g1, data = df,lambda = seq(-0.5, 0.0, by =0.05))
summary(g2)
g1 <- lm(mortality ~ income+ region+ income: region,df)
boxcox(g1, data = df, plotit =T)
boxcox(g1, data = df,lambda = seq(-0.5, 0.0, by =0.05))
g2 <- lm(I(mortality^(-0.2))~ income + region+ income: region,df)
boxcox(g2, data = df,plotit =T,lambda = seq(-2, 4, by =0.05))
summary(g1)
g3 <- lm(I(mortality^(-0.2)) ~ income+ region+ I(income^2) + I(income^3) + I(income^4)+I(income^5) +I(income^6),df)
summary(g3)
g4 <- lm(I(mortality^(-0.2)) ~ income+ region+ I(income^2) + I(income^3) + I(income^4)+I(income^5),df)
summary(g4)
plot(g4$fitted.values,g4$residuals,xlab="Fitted",ylab="Residuals",main="")
abline(h=0)
qqnorm(g4$residual,ylab="Residuals")
qqline(g4$residual)
halfnorm(lm.influence(g4)$hat,nlab=2,ylab="Leverages")
plot(g4$residuals/((summary(g4)$sig)*sqrt(1-lm.influence(g4)$hat)), g4$residuals,xlab="Studentized Residuals",ylab="Raw Residuals")
??halfnorm
g4$residuals
qqnorm(g4$residual,ylab="Residuals")
qqline(g4$residual)
summary(g3)
summary(g4)
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
df = df[, -4]
##transform the response
library(MASS)
g1 <- lm(mortality ~ income+ region+ income: region,df)
##find the outlier
cook <- cooks.distance(g1)
halfnorm(cook, nlab = 3,ylab = "Cook's distance")
df[c(-25, 72,27),]
df[-c(25, 72,27),]
df <- df[-c(25, 72,27),]
g1 <- lm(mortality ~ income+ region+ income: region,df)
boxcox(g1, data = df, plotit =T)
g2 <- lm(log(mortality)~ income + region+ income: region,df)
boxcox(g2, data = df,plotit =T,lambda = seq(-2, 4, by =0.05))
summary(g1)
summary(g2)
g4 <- lm(log(mortality ~ log(income)+ region+ log(income):region, df)
summary(g4)
g4 <- lm(log(mortality)~ log(income) + region+ log(income): region,df)
summary(g4)
plot(df$income, df$mortality)
identify(df$income, df$mortality)
plot(mortality ~income, df)
identify(income,mortality)
cook<-cooks.distance(g4)
halfnorm(cook,nlab=3,ylab="Cook's Distance")
plot(mortality ~income, df)
identify(income,mortality)
cook<-cooks.distance(g4)
halfnorm(cook,nlab=3,ylab="Cook's Distance")
plot(log(mortality) ~log(income), df)
g4 <- lm(log(mortality)~ log(income) + region,df)
summary(g4)
plot(df$income, df$mortality)
identify(df$income, df$mortality)
g4 <- lm(log(mortality)~ log(income) + region,df)
ti<-rstudent(g4)
pt(ti[72],df=101-5-1)
2*(1-pt(ti[4],df=101-5-1))-0.05/101
pt(ti[72],df=101-5-1)
##Compute the p-value and compare with alpha/n
2*(1-pt(ti[72],df=101-5-1))-0.05/101
pt(ti[25],df=101-5-1)
2*(1-pt(ti[25],df=101-5-1))-0.05/101
ti<-rstudent(g4)
pt(ti[72],df=101-5-1)
df[c(72,25,27),]
##Canada libya Saudi_Arabia
ti<-rstudent(g4)
pt(ti[72],df=101-5-1)
##Compute the p-value and compare with alpha/n
2*(1-pt(ti[72],df=101-5-1))-0.05/101
pt(ti[25],df=101-5-1)
2*(1-pt(ti[25],df=101-5-1))-0.05/101
library(faraway)
data(infmort)
attach(infmort)
##remove samples with missing data
df = na.omit(infmort)
df = df[, -4]
g4 <- lm(log(mortality)~ log(income) + region,df)
summary(g4)
plot(df$income, df$mortality)
identify(df$income, df$mortality)
plot(mortality ~income, df)
identify(income,mortality)
g4 <- lm(log(mortality)~ log(income) + region,df)
ti<-rstudent(g4)
pt(ti[72],df=101-5-1)
2*(1-pt(ti[72],df=101-5-1))-0.05/101
pt(ti[25],df=101-5-1)
2*(1-pt(ti[25],df=101-5-1))-0.05/101
pt(ti[27],df=101-5-1)
2*(1-pt(ti[27],df=101-5-1))-0.05/101
pt(ti[25],df=101-5-1)
2*(1-pt(ti[25],df=101-5-1))-0.05/101
df <- df[-27,]
df <- df[-27,]
g4 <- lm(log(mortality)~ log(income) + region,df)
g_cov <- lm(log(mortality)~log(time) *region,df)
anova(g_gov)
g_cov <- lm(log(mortality)~log(time)*region,df)
g_cov <- lm(log(mortality)~ log(income) + region + log(income):region,df)
anova(g_gov)
anova(g_cov)
g_cov <- lm(log(mortality)~ log(income)*region,df)
anova(g_cov)
g4 <- lm(log(mortality)~ log(income) + region,df)
summary(g4)
cook<-cooks.distance(g4)
halfnorm(cook,nlab=3,ylab="Cook's Distance")
g_cov <- lm(log(mortality)~ log(income)*region,df)
anova(g_cov)
plot(g4$fitted.values,g4$residuals,xlab="Fitted",ylab="Residuals",main="")
abline(h=0)
qqnorm(g4$residual,ylab="Residuals")
qqline(g4$residual)
halfnorm(lm.influence(g4)$hat,nlab=2,ylab="Leverages")
plot(g4$residuals/((summary(g4)$sig)*sqrt(1-lm.influence(g4)$hat)), g4$residuals,xlab="Studentized Residuals",ylab="Raw Residuals")
summatry(g4)
summary(g4)
